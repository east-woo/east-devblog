{"componentChunkName":"component---src-templates-post-jsx","path":"/CleanCode-10/","result":{"data":{"site":{"siteMetadata":{"title":"east-woo"}},"markdownRemark":{"id":"6b99e341-03c1-5ef1-b715-2f9e60cb34c9","excerpt":"Chapter 11. 시스템\npage 193 ~ 214 “복잡성은 죽음이다. 개발자에게서 생기를 앗아가며, 제품을 계획하고 제작하고 테스트하기 어렵게 만든다.” \n레이 오지(Ray Ozzie) 서론: 도시 만들기 도시를 세운다면? 도시를 세운다면 온갖 세세한 사항을 혼자서 직접 관리할 수는 없다. \n이미 세워진 도시라도 한 사람의 힘으로는 무리다. 그럼에…","html":"<p><strong>Chapter 11. 시스템</strong><br>\n<strong>page 193 ~ 214</strong></p>\n<blockquote>\n<p>“복잡성은 죽음이다. 개발자에게서 생기를 앗아가며, 제품을 계획하고 제작하고 테스트하기 어렵게 만든다.”<br>\n<strong>레이 오지(Ray Ozzie)</strong></p>\n</blockquote>\n<h2>서론: 도시 만들기</h2>\n<h4>도시를 세운다면?</h4>\n<p>도시를 세운다면 온갖 세세한 사항을 혼자서 직접 관리할 수는 없다.<br>\n이미 세워진 도시라도 한 사람의 힘으로는 무리다. 그럼에도 불구하고 도시는 돌아간다.<br>\n도시가 돌아가는 이유에는 수도 관리, 전력 관리, 교통 관리 등 각 분야를 관리하는 팀이 있기 때문이다.<br>\n도시에는 큰 그림을 그리는 사람들도 있으며 작은 사항에 집중하는 사람들도 있다.<br>\n도시가 돌아가는 또 다른 이유는 적절한 추상화와 모듈화 때문이다.<br>\n그래서 큰 그림을 이해하지 못하더라도 개인과 개인이 관리하는 ‘구성요소’는 효율적으로 돌아간다.\n<br></p>\n<p>소프트웨어 팀도 도시처럼 구성한다. 그런데 막상 팀이 제작하는 시스템은 비슷한 수준으로 관심사를 분리하거나 추상화를 이뤄내지 못한다.<br>\n깨끗한 코드를 구현하면 낮은 추상화 수준에서 관심사를 분리하기 쉬워진다.<br>\n이 장에서는 높은 추상화 수준, 즉 시스템 수준에서도 깨끗함을 유지하는 방법을 살펴본다.</p>\n<h2>1. 관심사 분리</h2>\n<h4>construction(생성)과 use(사용)은 아주 다르다</h4>\n<ul>\n<li>소프트웨어 시스템은 (어플리케이션 객체를 제작하고 의존성을 서로 '연결’하는) <strong>준비 과정</strong>과 (준비 과정 이후에 이어지는) <strong>런타임 로직</strong>을 분리해야 한다.</li>\n<li><strong>객체의 생성과 객체를 사용하는 부분을 분리한다</strong></li>\n</ul>\n<h3>1) 시작에 대한 관심사 분리</h3>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 655px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/a334be23eee0715c7b82d1e2a20e84d3/2728a/img.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQoz12TWW7CQBBEff9r8MkZ+CBICAQCJMCAFzazGrMvxmDo+HU0KElL7bFmqreqGev5fMrlcpHr9SpxHOt6Pp8lTVMxBgY3drvdPngTw/p+v8WaTqeyXq9lu93KbDaT3W4ny+VSxuOxvF4v4bxUKkm73dakh8NBHMeRzWaj+CAIJIoiGQ6HWsgi0BiHxlzX1c4p5nmeBhFAsslkIqfTSTG+7+s0q9VK96zRaCTValVarZY0m01dy+WysI8ZOowlSaL4RqOhTgxeq9Xkfr+LxRiMSaeFQkH6/b7s93sNxDhbLBYShuGHx+PxqB1TlLEZH94xi3YJBmzbth48Ho8/IpgkkG66xObzue6bPRUF3ugChy8AVAQMgHH57/V6+g+PTEF3cNjpdJRXuERpy3CFenRo+ALEOMViUXK5nOTzeRWHZIPBQBPDZaVS0anAsqrKkEoy4/V6XYz6dM7VIQEG8YhBx+CIpQBiqijwxb2DeBz5cTgEEK5DrRzf4k/3FIEGKAJLd0yoosg/4zJj6TPNkq2k9PWl3TgDR3n7/YL+m4rCxyRJkrvY3W72KjrS69rie75MstG9jHzXcWWYER9MA50o2kQ/z01+4s0N+Aa7PYOrnalUYwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img' title='img' src='/static/a334be23eee0715c7b82d1e2a20e84d3/2728a/img.png' srcset='/static/a334be23eee0715c7b82d1e2a20e84d3/e7570/img.png 170w,\n/static/a334be23eee0715c7b82d1e2a20e84d3/f46e7/img.png 340w,\n/static/a334be23eee0715c7b82d1e2a20e84d3/2728a/img.png 655w' sizes='(max-width: 655px) 100vw, 655px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h4>객체의 생성은 시작단계에서, 비즈니스 로직은 객체를 사용하는데 집중한다</h4>\n<ul>\n<li>시작 단계는 모든 어플리케이션이 풀어야할 관심사이다.</li>\n<li>main 함수에서 시스템에 필요한 객체를 생성한 후 어플리케이션에 넘긴다.</li>\n<li>어플리케이션은 그저 만들어진 객체를 사용한다.</li>\n<li>모든 객체가 잘 생성되었다고 가정하고, 객체를 이용한 개발에 집중할 수 있다.</li>\n</ul>\n<h3>2) 요청에 대한 관심사 분리</h3>\n<h4>spring 프레임 워크를 통해 요청에 대한 관심사를 분리해 요청 처리에 대한 비즈니스 로직에 집중할 수 있다</h4>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/026fc6f0c08137c3a99b5c9d5af6ff11/65207/img_1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 46.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB/0lEQVQoz1WSe0/TUBjG+b7+5SfwOxiEmJjMGC9gRMWIDISJ8ZLABHSwcRnbXLe1HbTrLu1pe3r5eU5lJr7JyUnb9336PM/7LKRpShiGxZFSosuXPk7oqDsgz3NENCYIXeLEJ01SghsPKSJy1TufjaKo6F0QQpAkSfFx0uvhbe1wXl7luFLiovwSZ2sbs1zipvIYY6OE+eYtjfuPqD54iLH+mnAyLkjMcRY0uoIuXs4GA9zND1zurFLbK9H8uIpb2WZYeY739QXN9ys0XpXpvNvn5/JTmutb2L+7xWwcx38BgyAgCHxFOWM2aSGny5yc32P74A7V47sE4xWC7IqEBmG0Rru+Qn1jkcv9J4xGnwiFkq9s8H1lh7KvALQsC9O0ca47CHuXprVGzXvGlb2mJB0i5Lmy5Ez5+A3XOEEcHTJu/mIybmEODIbDIbZtk2XZreTb6jo9lqolqtc1vrj7XAV9JSOnZ32na+5hj84QrqC/W8O9tEjVjJTJ/5I1oEbW1Xf7LB0scjT6QZ0T2kJZEAdMwxpRVmMWXzAduohqC79jqa3LAkiX3vI/QP2gI+N5Hp6KRHva5jQ5xRAGiYyZijPCpIEfd5g5Y4zPx4xain2mIqS800DausJDzU7/RZ/8dttJmqjsieLWeZIyIop1LGTRE4lQ5VFHLS+IzOXq+gPpH5waUG03YgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img 1' title='img 1' src='/static/026fc6f0c08137c3a99b5c9d5af6ff11/65207/img_1.png' srcset='/static/026fc6f0c08137c3a99b5c9d5af6ff11/e7570/img_1.png 170w,\n/static/026fc6f0c08137c3a99b5c9d5af6ff11/f46e7/img_1.png 340w,\n/static/026fc6f0c08137c3a99b5c9d5af6ff11/65207/img_1.png 558w' sizes='(max-width: 558px) 100vw, 558px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p><strong>Filter, lntercepter, AOP</strong></p>\n<ul>\n<li>서블릿 필터는 Dispatcher Servlet 이전에 실행이 되는데, 요청 내용을 변경하거나 요청을 처리하기 전에 작업을 수행할 수 있다.</li>\n<li>Filter와 Interceptor는 Servlet 단위에서 실행된다. 반면 AOP 는 메소드 앞에서 Proxy 패턴으로 실행된다.</li>\n<li>인터셉터는 여러 개를 사용할 수 있고 로그인 처리, 권한 체크, 프로그램 실행시간 계산작업, 로그 확인 등의 업무 처리에 활용된다.</li>\n<li>AOP는 메서드 앞에서 Proxy 패턴으로 실행된다. 주로 '로깅', '트랜잭션', '에러처리' 등 비즈니스 단의 메서드에서 조금 더 세밀하게 조정하고 싶을 때 사용한다. AOP는 주소, 파라미터, 어노테이션 등 다양한 방법으로 대상을 지정할 수 있다.</li>\n</ul>\n<hr>\n<h2>2. Dependency Injection(의존성 주입)</h2>\n<h4>객체 의존성을 DI 컨테이너에 맡긴다</h4>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 382px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/038b7f1cd025c1986deaf12111a29fd7/29984/img_2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACkUlEQVQoz02R208bVxCH/XcT2hA1QREv5SVSpDRpRfsQEUEaE0igKUbgxQZfwazteA2b9WVtB/B177v217OnEspIozOac843M79JBO6UTvE1hvKcysFTMu+XUbYfkf/4mMbRKtfHzxi2skS+RSP9gvMPyxR3n3Ce/JnS3hMRr5DbeSziFfkucWsUUA9WqKUE8Msqpc+rFD89pSjOVnadTnYNPfcH/WuFXHKJ1LtlUptLZD6sUNj7hfT2TzKnvF9CO31JYjadspu+4tVekYKqM/h+T+VmgO96fNV71Ft3RGHIaDjkU7bO5tEVG4cqpeoNNc3gTVLh990srz9m5d/EdDLhz8/nrG2dcXJ2iVqts5Uqctfr8G+mzD/ZCvPAZSiAf30psb59ynqyzGE6z3m5ytrbI55t7PPr5gmm2SPhOg7aTYuz/AWG0aKpNfFclwebRwS+jzWd0NDbNIw+l3Wdu/sh05lN7qJGrqSKuy6T8ZjEPAppd0yOz8rY1ow3OwqVmiZAIZZlS6bve/IutkHHwJmORBGP65rK3HfRa1cErk0YBgIY+GitHjsnFzI5mlqyw8plRUpxez8iLupYFo7QdWMvg94d0GwPeJcqY42HbB3mUcoNiIL/R47tttelon59mDQQi6hq33AFJAwC7NmMxWJB+VKlb5pC0zGZ0yy2kKJULNM1+2J5PwDN70N++/uYfn/ATVNjNBo/wH3Pw7EtgiBk+0BBNzoYosut/TQsIvbTBYpqU8okgYv5nLmoHoscW1KMn8pVZbwQHkvgCqAvOj0u1IUMYwb3E5QLTS4tX9OpXbfFxH68lIgY6rmOFNr3XFrtDmbXlLFj23LLkXgXgxehL/OB8HngCUkceUbxX+H/ASXDEsUcuWdwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img 2' title='img 2' src='/static/038b7f1cd025c1986deaf12111a29fd7/29984/img_2.png' srcset='/static/038b7f1cd025c1986deaf12111a29fd7/e7570/img_2.png 170w,\n/static/038b7f1cd025c1986deaf12111a29fd7/f46e7/img_2.png 340w,\n/static/038b7f1cd025c1986deaf12111a29fd7/29984/img_2.png 382w' sizes='(max-width: 382px) 100vw, 382px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>Setter 메소드 or 생성자 인수를 통해 의존성을 주입한다.</li>\n<li>DI 컨테이너는 요청이 들어올 때 필요한 객체의 인스턴스를 만든 후 의존성을 설정한다.</li>\n<li>예 : Spring IOC Container</li>\n</ul>\n<h3>Spring IoC Container</h3>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 439px; '>\n      <a class='gatsby-resp-image-link' href='/static/ea3275ec3852b88c08dd87ed2f0197da/54b61/img_3.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQoz4WS3U4TURSFDwlXXEPCS3DRN+BVeALueQPTQFA0MSQYozfShOBFTR2hapoWE0AM2qYt03amSGFa+jftYP+m83lmdKApRXeyzsnZZ+81a+0zwnEchsPhPbh5P9qtFoV8nkwmQyqVQtM0stksyWQSVVVJp9Pkcjls20ZMInRz/cGAm18dOr0e5etrzHabTrfrwb33+/wP+71iVMloFMoVlLM8n7Qie2rB2/fzOl/kbvf7jAvxz8JdTNOkUqlQq9WoVquYjQanmk5EO2f3e4rtoxPeHH4lLIkT5xcMpGrnrypfrQ9PYVfaiEajhEIhFEXhqlRCNcpECkXeSsKXn2O8isV5l9NIFH96Ct2Y5M5T6IZlWdTrdZrNpndWDYPwmYpS0CR0opJIkXbjuv5vQt/7aHhzGUC/40h7YNZvMEpVKld1LLNzR+Yw2fLocO2h7TXoDfkAFwd8K5/wMRvl/Y8Ie+kPHGgJ+vadwgcJ/YRfvLy/jAgKxBOJxxJPJTYEc5tzXDYv/zhxhg9bHidcia8w/3qexfCih8BOgIWdBQLbAYyWcUv4X4U9u+cVL0WWEI8Esy9mmdmcYfr5NOKZYGpjilKz5NW44xn/F+8R+jOM6TGCh0HWjtc8rB+vs3q0ytbpFlbXun288f7fDcppF6bWqxgAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img_3.png' title='img_3.png' src='/static/ea3275ec3852b88c08dd87ed2f0197da/54b61/img_3.png' srcset='/static/ea3275ec3852b88c08dd87ed2f0197da/e7570/img_3.png 170w,\n/static/ea3275ec3852b88c08dd87ed2f0197da/f46e7/img_3.png 340w,\n/static/ea3275ec3852b88c08dd87ed2f0197da/54b61/img_3.png 439w' sizes='(max-width: 439px) 100vw, 439px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>img_3.png</figcaption>\n  </figure></p>\n<ul>\n<li>DI 컨테이너가 객체를 알아서 wiring 해준다.</li>\n</ul>\n<hr>\n<h2>3. Cross Cutting Concerns(횡단 관심 분리)</h2>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 562px; '>\n      <a class='gatsby-resp-image-link' href='/static/a57259b1a93806a1434da370c93fdd54/a4f00/img_4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcklEQVQ4y4WTi66CQAxE+f8fNDGABJQoL1+Aimi9p8kQNJq7Sdntlk47bTewv/V8Pu1zPR4Pl/v9btfr1Xf0YRhcl53z7XabMAI+fd/b4XCw/X7vwrnrOv+5bVs7nU4ul8vF72VH5/54PDoGARyQiziObblcWhRFFoah1XXtYNjYm6ax8/nsAZMkmQJxRwDEAUn1G+VxHF3IAicywgFHAuNDGQDGjo07z5BIaZpanue2Xq89C4AQMlytVg5ECcgcBtjQ8auqagrogETZ7XZWlqXvqhF1AXyxWDhldAAJoBpSoqIo3gE5fC7oiDIM5pSpNzb+Qcf+RllNybLMKSDURfVTc9DJlAzV8fkUTBlihBpO6pgozwHRcQR0bpfNM/zW4U/qgDDQLBqBLj/Npx5IoMMvEahEL0U1ROb/B9+yEpBmTQ1CV6PUzDno9PR+AeKAMzs13m63PqebzcbPjBABeMualH8zhCJO0KTwagZCMFGXzwtgIj+ZvBUfLAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Cross Cutting Concerns' title='Cross Cutting Concerns' src='/static/a57259b1a93806a1434da370c93fdd54/a4f00/img_4.png' srcset='/static/a57259b1a93806a1434da370c93fdd54/e7570/img_4.png 170w,\n/static/a57259b1a93806a1434da370c93fdd54/f46e7/img_4.png 340w,\n/static/a57259b1a93806a1434da370c93fdd54/a4f00/img_4.png 562w' sizes='(max-width: 562px) 100vw, 562px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Cross Cutting Concerns</figcaption>\n  </figure></p>\n<h4>어플리케이션 전반에서 가지는 공통적인 관심사 분리한다.</h4>\n<ul>\n<li>비즈니스 로직 외에 Logging, Transaction 관리, Security 등 신경써야할 관심사들이 많다.</li>\n<li>관심사들은 많은 어플리케이션 레이어에 퍼져있는데, 이 관심사들을 분리해 처리하는 것이 효율적이다.</li>\n</ul>\n<h3>횡단 관심사 분리의 필요성</h3>\n<h4>예제 1. before</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Response</span> <span class=\"token function\">executeBusinessLogic</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Request</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 공통 기능</span>\n  <span class=\"token function\">checkAuth</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 비즈니스 로직</span>\n  <span class=\"token class-name\">Response</span> response <span class=\"token operator\">=</span> <span class=\"token function\">businesslogic</span><span class=\"token punctuation\">(</span>userName<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 공통 기능</span>\n  <span class=\"token function\">logging</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>예제 2. after</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Response</span> <span class=\"token function\">executeBusinessLogic</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Request</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 비즈니스 로직</span>\n  <span class=\"token class-name\">Response</span> response <span class=\"token operator\">=</span> <span class=\"token function\">businesslogic</span><span class=\"token punctuation\">(</span>userName<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 공통 기능은 별도의 코드에서 관리한다.</span></code></pre></div>\n<ul>\n<li>비즈니스 로직에 집중할 수 있다</li>\n</ul>\n<h3>(Step.1) Java Proxy API</h3>\n<ul>\n<li>자바에서 사용하는 관점 혹은 관점과 유사한 매커니즘들을 알아보자.</li>\n<li>자바 프록시는 단순한 상황에 적합한다.</li>\n<li>개별 객체나 클래스에서 메서드 호출을 감싸는 경우가 좋은 예시이다.</li>\n<li>\n<p>하지만 JDK에서 제공하는 동적 프록시는 인터페이스만 지원하며, 클래스 프록시를 사용하려면 CGLIB, ASM, Javassist 등과 같은 바이트 코드 처리를 위한 라이브러리가 필요하다.</p>\n<blockquote>\n<p>참고<br/>\n<strong>CGLIB</strong> : Code Generator Library의 약자로 런타임에 동적으로 자바 클래스의 프록시를 생성해준다.<br/>\n<strong>ASM</strong> : 자바 바이트 코드 조직 및 분석 프레임워크<br/>\n<strong>Javassist</strong> : 동적으로 자바 클래스로 변경하는 바이트 코드 라이브러리<br/></p>\n</blockquote>\n</li>\n</ul>\n<h4>Bank 객체에 Proxy API를 통해 영속성을 추가하는 과정</h4>\n<p>이해를 위해 계좌 목록을 가져오는 설정하는 메서드만 살펴보자.<br/>\n먼저 프록시로 감쌀 Bank 인터페이스를 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// Bank.java</span>\n<span class=\"token comment\">// 은행 추상화</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Bank</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">setAccounts</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이후 비즈니스 로직을 구현하는 POJO인 BankImpl을 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// BankImpl.java</span>\n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token operator\">*</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 추상화를 위한 POJO 구현</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BankImpl</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Bank</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Collectioin</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> accounts<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setAccounts</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accounts <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Account</span> account<span class=\"token operator\">:</span> accounts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accounts<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>프록시를 구현하려면 InvocationHandler 를 구현해야 한다.<br/>\n구현한 InvocationHandler는 프록시에 호출되는 Bank의 메서드를 구현하는데 사용한다.<br/>\nBankProxyHandler는 리플렉션을 이용해 제네릭스 메서드를 이에 상응하는 BankImpl 메서드로 매핑한다.<br/></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// BankProxyHandler.java</span>\n\n<span class=\"token comment\">// 프록시 API가 필요한 \"InvocationHandler\"</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BankProxyHandler</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">InvocationHandler</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Bank</span> bank<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">BankProxyHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Bank</span> bank<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>bank <span class=\"token operator\">=</span> bank<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// InvocationHandler에 정의된 메서드</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">invoke</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> proxy<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Method</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throw</span> <span class=\"token class-name\">Throwable</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">String</span> methodName <span class=\"token operator\">=</span> method<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>methodName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getAccounts\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          bank<span class=\"token punctuation\">.</span><span class=\"token function\">setAccounts</span><span class=\"token punctuation\">(</span><span class=\"token function\">getAccountsFromDatabase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span> bank<span class=\"token punctuation\">.</span><span class=\"token function\">getAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>methodName<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setAccounts\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          bank<span class=\"token punctuation\">.</span><span class=\"token function\">setAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span> args<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">setAccountsToDatabase</span><span class=\"token punctuation\">(</span>bank<span class=\"token punctuation\">.</span><span class=\"token function\">getAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 세부사항은 여기에 이어진다.</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getAccountsFromDatabase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setAccountsToDatabase</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 자바 Proxy API를 통해 호출</span>\n<span class=\"token class-name\">Bank</span> bank <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Bank</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">.</span><span class=\"token function\">newProxyInstance</span><span class=\"token punctuation\">(</span>\n    <span class=\"token class-name\">Bank</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClassLoader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">Class</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> <span class=\"token class-name\">Bank</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> \n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">BankProxyHandler</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BankImpl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>lnvocationHandler를 구현하는 BankProxyHandler를 생성한다. Java Reflection API를 이용해 Bank 인터페이스를 구현하는 객체의 메서드 호출을 가져온다. 데이터 베이스에서 데이터를 가져오는 과정을 추가한다.</li>\n<li>ProxyAPI를 호출할 때 BankImpl 객체를 통해 생성한 BankProxyHandler와 Bank 인터페이스를 사용해 프록시된 인터페이스를 사용해 모델과 로직이 분리된 코드를 작성할 수 있다.<br/>\n⇒ 보시다시피 장점대비, 코드의 복잡성이 아직도 있음</li>\n<li>예제에서 알 수 있다시피, 자바 프록시는 코드의 양이 매우 커지는 것이 단점이다.</li>\n</ul>\n<blockquote>\n<p><strong>참고</strong> <br>\n동적 프록시가 아닌 일반 프록시는 대상 클래스 수만큼 프록시 클래스를 만들어야하며, 비슷한 코드의 중복이 발생하기 쉽다.</p>\n</blockquote>\n<h3>(Step.2) 순수 Java AOP Framework</h3>\n<h4>스프링 2.5 설정 파일의 일부</h4>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>beans</span><span class=\"token punctuation\">></span></span>\n    ...\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>bean</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>appDataSource<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>org.apache.commons.dbcp.BasicDataSource<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">destroy-method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>close<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">p:</span>driverClassName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.mysql.jdbc.Driver<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">p:</span>url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>jdbc:mysql://localhost:3306/mydb<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">p:</span>username</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>me<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>bean</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bankDataAccessObject<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.example.banking.persistence.BankDataAccessObject<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">p:</span>dataSource-ref</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>appDataSource<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>bean</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bank<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.example.banking.model.Bank<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\"><span class=\"token namespace\">p:</span>dataAccessObject-ref</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bankDataAccessObject<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span>\n    ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>beans</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>각 bean은 러시아 인형의 일부분과 같다.</li>\n<li>Bank 도메인 객체는 bankDataAccessObject(DAO)로 감싸며, DAO는 JDBC 드라이버 데이터 소스로 감싸진 형태로 구성된다.</li>\n</ul>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/75915208934da1a93dfd553ea0d12350/0a8ae/img_5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 42.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQoz4WQSYvCQBCF+///CiHgLi548CC4L6jEg2BEo5PkoNEg7vvyTD3QgwwzBY+q7qS+flUKfhyPRxwOh4/2+z2u1yvecb/foes6Wq0W0uk0AoEAgsEgFYvFUKvVUCqVsF6voVzXhWiz2VByud1uYVkWTqfTB1gsFglLJBKESE4mk6wzmQzrxWIBNR6Pcblc2DgYDLBcLlmbpgnHceh+MpkglUqhXC4TLG5Eci4UCuh0OsjlchiNRlDSOBwO6VLgtm3zJRlxt9sRfj6fCZBvMkW73eYk8lCj0WCOx+MwDANqtVqhXq9TzWaTP1SrVfR6PTyfTwJvtxvy+TzvBSauJFcqFTrudrvQNI1rUvgj3kAJaQqFQohEItxbOBxGNBqlM7nLZrNcj5Kmx+PB5m9JyDimvxtZied5+C/UN0Dy3J1jNp3CsR3CjH4fPz5Yzo6/R9uy4c7cX028ANsrQOzXTUlNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img 5' title='img 5' src='/static/75915208934da1a93dfd553ea0d12350/0a8ae/img_5.png' srcset='/static/75915208934da1a93dfd553ea0d12350/e7570/img_5.png 170w,\n/static/75915208934da1a93dfd553ea0d12350/f46e7/img_5.png 340w,\n/static/75915208934da1a93dfd553ea0d12350/0a8ae/img_5.png 564w' sizes='(max-width: 564px) 100vw, 564px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>클라이언트는 Bank 객체에서 getAccount()를 호출한다고 믿지만 실제로는 Bank POJO의 기본 동작을 확장한 중첩 Decorator 객체 집합의 가장 외곽과 통신한다.</li>\n<li>필요에 따라 트랜잭션, 캐싱 등에도 Decorator를 추가할 수 있다.</li>\n</ul>\n<p>애플리케이션에서 DI 컨테이너에게 프록시 객체를 요청하려면 다음 코드가 필요하다</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">  <span class=\"token class-name\">XmlBeanFactory</span> bf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">XmlBeanFactory</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassPathResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"app.xml\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token class-name\">Bank</span> bank <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Bank</span><span class=\"token punctuation\">)</span> bf<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"bank\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>스프링 관련 자바 코드가 거의 필요 없으므로 애플리케이션은 <strong>사실상 스프링과 독립적이다.</strong></p>\n<ul>\n<li>EJB2 시스템이 가졌던 강한 결합이라는 문제가 모두 사라진다.</li>\n<li>이런 아키텍처를 통해 스프링 프레임워크는 EJB 버전 3을 완전히 뜯어고치는 계기를 제공했다.\n<br/>\n<br/></li>\n<li>순수 자바 관점을 구현하는 스프링 AOP, JBoss AOP 프레임워크는 내부적으로 프록시를 사용한다.</li>\n<li>설정 파일이나 API를 사용해 객체의 역할을 설정한다</li>\n<li>Bank 객체는 DAO로 프록시되었다.</li>\n<li>객체를 얻어올 때는 (XML 파일에 설정했던) DI 컨테이너에게 객체를 요청(getBean) 한다.\n<br/>\n<br/></li>\n<li>대부분의 프록시 코드는 비슷한 코드로 구성되어 있어 자동화가 가능하다.</li>\n<li>스프링의 경우 비즈니스 로직을 POJO로 구현한다.</li>\n<li>POJO는 순수하게 도메인에 초점을 맞추기 때문에 엔터프라이즈 프레임워크에 의존하지 않는다. 따라서 테스트가 개념적으로 더 쉽고 간단한다. </li>\n<li>자바 프레임워크를 통해 영속성, 트랜잭션, 보안, 캐시, 예외 처리 등과 같은 횡단 관심사를 구현할 수 있다.</li>\n</ul>\n<h3>(Step.3) EJB3 - JPA같은 객체 영속성 관리 표준 API</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Entity</span>\n<span class=\"token annotation punctuation\">@Table</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"BANKS\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Bank</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span>Serializable</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Id</span> \n    <span class=\"token annotation punctuation\">@GeneratedValue</span><span class=\"token punctuation\">(</span>strategy<span class=\"token operator\">=</span><span class=\"token class-name\">GenerationType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> id<span class=\"token punctuation\">;</span>\n    \n    <span class=\"token annotation punctuation\">@Embeddable</span> <span class=\"token comment\">// Bank의 데이터베이스 행에 '인라인으로 포함된' 객체</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Address</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">String</span> streetAddr1<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">String</span> streetAddr2<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">String</span> city<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">String</span> state<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token class-name\">String</span> zipCode<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token annotation punctuation\">@Embedded</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Address</span> address<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@OneToMany</span><span class=\"token punctuation\">(</span>cascade <span class=\"token operator\">=</span> <span class=\"token class-name\">CascadeType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ALL</span><span class=\"token punctuation\">,</span> fetch <span class=\"token operator\">=</span> <span class=\"token class-name\">FetchType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">EAGER</span><span class=\"token punctuation\">,</span> mappedBy<span class=\"token operator\">=</span><span class=\"token string\">\"bank\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setId</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">addAccount</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Account</span> account<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        account<span class=\"token punctuation\">.</span><span class=\"token function\">setBank</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        accounts<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>account<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">getAccounts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> accounts<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setAccounts</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collection</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Account</span><span class=\"token punctuation\">></span></span> accounts<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>accounts <span class=\"token operator\">=</span> accounts<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p>EJB2 코드보다 훨씬 깔끔해졌다.</p>\n<ul>\n<li>모든 정보가 어노테이션 내부로 갈무리되어 코드가 깔끔해진 것이고, 그만큼 코드를 테스트하거나 유지보수하기 쉬워졌다.</li>\n</ul>\n</li>\n<li>annotation에 있는 영속성 정보 전부 또는 일부를 XML 설정으로 옮겨도 된다.\n(실무에서는 annotation 사용을 선호한다)</li>\n</ul>\n<h3>AspectJ 관점</h3>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 233px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/347599a37159f79b2b156fd52457fa3f/ff7a3/img_6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 35.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABJElEQVQoz5VRzU6DQBjkxTz6BmqA/QFkg02ggQIVOTSePLhKgwkJhz5CE/UNx/22gNV48TDZyWS/2dn5HCklpBAQdP4TYpoTZx6OECch4MyKvu9bMMYWfg7SCdwgjCKEgptZvpg6M7lWKaS6w7aukOc5iqJAVVUoy9Ji1tq2hdYaaZZh/6pxo1ZwbxPjcTJ1iLBI4aLWWJdbfH68o9vvMY4jhmHA4XDA8Xi0vOs6a06cmxD9i8bV+h6X5RNC5k1fpu9SwihBkuV43O2Qmdfb9gF9/2aT1XWNNE3RNA2SJLHJi80GnX6GG6/gh/F3wlOHwnbBmQ/X9cBNJ9QXFT93N2u0CM/zoJRCHBsjMzObTR0KQ+Sy5SAIfmzxr+3SHXqAIH9t+Qvt8TNtwKbK0QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='img 6' title='img 6' src='/static/347599a37159f79b2b156fd52457fa3f/ff7a3/img_6.png' srcset='/static/347599a37159f79b2b156fd52457fa3f/e7570/img_6.png 170w,\n/static/347599a37159f79b2b156fd52457fa3f/ff7a3/img_6.png 233w' sizes='(max-width: 233px) 100vw, 233px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>관심사를 관점으로 분리하는 가장 강력한 도구는 AspectJ 언어이다.</p>\n<p>AspectJ는 언어 차원에서 관점을 모듈화 구성으로 지원하는 자바 언어의 확장이다.</p>\n<p>스프링 AOP와 JBoss AOP가 제공하는 순수 자바 방식은 관점이 필요한 상황의 80~90% 정도를 충족해준다.</p>\n<p>AspectJ는 나머지 10%를 채워주는 좋은 도구이지만, 새로운 도구이니만큼 사용법과 언어 문법을 익혀야할 필요성은 있다.</p>\n<p>AspectJ의 어노테이션 폼(annotation form)은 이 부담감을 경감시켜주긴 한다.</p>\n<p>어노테이션 폼은 순수한 자바 코드에 자바 5 어노테이션을 사용해 관점을 정의하기에 AspectJ에 대해 미숙한 상태여도 쉽게 사용할 수 있도록 해준다.</p>","frontmatter":{"title":"[클린코드-10] 클래스 잘 설계하기","date":"July 04, 2024","update":"July 04, 2024","tags":["독서","Clean Code"],"series":"Clean Code"},"fields":{"slug":"/CleanCode-10/","readingTime":{"minutes":15.54}}},"seriesList":{"edges":[{"node":{"id":"b406bb1d-20e8-56cf-aeb9-372b40275c78","fields":{"slug":"/CleanCode-1/"},"frontmatter":{"title":"[클린코드-1] 클린 코드와 그 첫걸음"}}},{"node":{"id":"d34f1573-694e-5d31-9fc0-6abc568f788b","fields":{"slug":"/CleanCode-2/"},"frontmatter":{"title":"[클린코드-2] 함수를 안전하고 간결하게 작성하기"}}},{"node":{"id":"2561081f-3b40-5810-aed4-4688770e362d","fields":{"slug":"/CleanCode-3/"},"frontmatter":{"title":"[클린코드-3] 코드를 보조하는 주석"}}},{"node":{"id":"8bfe4c44-e879-5335-b3be-9acce01ed2f5","fields":{"slug":"/CleanCode-4/"},"frontmatter":{"title":"[클린코드-4] 코드의 가독성에 필수적인 포맷팅"}}},{"node":{"id":"cdf67bfa-eb4b-5d41-98f4-02a410c11737","fields":{"slug":"/CleanCode-5/"},"frontmatter":{"title":"[클린코드-5] 객체와 자료구조로 데이터 표현하기"}}},{"node":{"id":"7725a8eb-56b3-5e37-b8c3-fbb65def1d62","fields":{"slug":"/CleanCode-6/"},"frontmatter":{"title":"[클린코드-6] 우아하게 예외 처리하기"}}},{"node":{"id":"4e262a40-e19d-5830-a48c-e46c38f62ce8","fields":{"slug":"/CleanCode-7/"},"frontmatter":{"title":"[클린코드-7] 모호한 경계를 적당히 구분짓기"}}},{"node":{"id":"be7a0d17-10d6-5dda-b0ad-86b9b87794df","fields":{"slug":"/CleanCode-8/"},"frontmatter":{"title":"[클린코드-8] 깨끗한 테스트 코드"}}},{"node":{"id":"7cffdb26-f508-50f1-ac60-9d891e5a4456","fields":{"slug":"/CleanCode-9/"},"frontmatter":{"title":"[클린코드-9] 클래스 잘 설계하기"}}},{"node":{"id":"6b99e341-03c1-5ef1-b715-2f9e60cb34c9","fields":{"slug":"/CleanCode-10/"},"frontmatter":{"title":"[클린코드-10] 클래스 잘 설계하기"}}},{"node":{"id":"de25428c-8bc8-5e86-8726-6dbcb1b4bf08","fields":{"slug":"/CleanCode-11/"},"frontmatter":{"title":"[클린코드-11] 창발적 설계로 깔끔한 코드 구현하기"}}}]},"previous":{"fields":{"slug":"/CleanCode-9/"},"frontmatter":{"title":"[클린코드-9] 클래스 잘 설계하기"}},"next":{"fields":{"slug":"/CleanCode-11/"},"frontmatter":{"title":"[클린코드-11] 창발적 설계로 깔끔한 코드 구현하기"}}},"pageContext":{"id":"6b99e341-03c1-5ef1-b715-2f9e60cb34c9","series":"Clean Code","previousPostId":"7cffdb26-f508-50f1-ac60-9d891e5a4456","nextPostId":"de25428c-8bc8-5e86-8726-6dbcb1b4bf08"}},"staticQueryHashes":[]}